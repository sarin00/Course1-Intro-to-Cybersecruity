## 1. Термінал (CLI)
При першому відкритті терміналу ви побачите приблизно такий текст:
`myusername@ubuntuserver:~$`
* Строка починається з імені вашого користувача в цій ОС. Якщо ви підвищите свої привілеї, замість імені побачите слово root.
* Після символу `@` вказано імʼя операційної системи, з якою ви зараз працюєте. В цьому випадку, сервер має назву `ubuntuserver`. Зазвичай імʼя ОС відображає основну функцію, яку виконує ОС.
* Після `:` вказана директорія, в якій ви зараз знаходитесь.
* Останній смивол показує привілеї користувача. `#` означає привілеї root (адміністративні привілеї), а `$` означає привілеї звичайного користувача.

## 2. Основні команди
Термінал дає нам можливість спілкуватись з ОС. Для виконання різних задач потрібні різні команди. Ось список базових найпоширеніших команд:

### Файлові команди:
Символи `<` та `>` використовуються, щоб показати на якому місці в команді потрібно вказати аргумент. Ці символи при написанні команди у термінал використовувати не потрібно.
```
`ls` - Показати вміст поточної директорії.
`ls -l` - Показати вміст поточної папки у вигляді списку.
`ls -al` - Показати вміст поточної папки з усіма прихованими файлами у вигляді списку.
`cd <folder>` - Змінити директорію на папку під назвою folder. При такій команді nextfolder має бути всередині тієї папки, в якій ми знаходились під час виконання команди.
`mkdir <новапапка>` - Створити нову папку з імʼям новапапка.
`rm <file.txt>` - Видалити файл з назвою file.txt.
`rm -r <myfolder>` - Видалити папку з назвою myfolder.
`cp <file1> <file2>` - Скопіювати файл з назвою file1 у новий файл з назвою file2.
`cp -r <folder1> <folder2>` - Скопіювати папку folder1 у папку folder2.
`cat <file.txt>` - Прочитати вміст файлу file.txt та вивести його в термінал.
```

### Управління ОС
```
`sudo <command>` - Виконати команду command з привілеями root.
`ps` - Показати всі запущені процеси.
`htop` - Показати всі запущені процеси та навантаження компʼютера в зрозумілому вигляді.
`kill -9 <id>` - Зупинити процес з вказаним id (ідентифікаційним номером процесу).
`chmod` - Змінює права доступу до файлу. Одне з найпоширеніших застосувань chmod — це зробити файл таким, що виконується.
`apt install <packagename>` - Встановлення програми/пакету з імʼям packagename. 
`ssh username@xxx.xxx.xxx.xxx` - Підключитись по SSH до ОС з адресою xxx.xxx.xxx.xxx та користувачем на імʼя username.
`man <command>` - Подивитись інструкцію використання команди під назвою command.
```

## 3. Директорії (папки) та шляхи
Як і інші ОС, Linux має свою файлову систему. Під словом "система" варто розуміти "впорядкованість", адже для всього є своє місце. У Windows основним диском є диск C:\, на якому зберігаються файли ОС у папці "Windows", дані користувачів у папці "Users\Username", і т.д. Замість диска C:\ в лінуксі основною директорією виступає `/`  - його ще називають root-директорією. У цій директорії `/` зберігаються наступні папки:
```
`/bin` - Команди операційної системи.
`/boot` - Ядро ОС та дані для її завантаження.
`/dev` - Файли пристроїв, наприклад флешки.
`/etc` - Конфігураційні файли (файли налаштувань) ОС та деяких програм.
`/home` - Папка, в якій створюються "домашні папки" користувачів ОС. В цих домашніх папках знаходяться стандартні речі типу Desktop, Downloads, та інше. Домашня директорія вашого користувача матиме такий шлях: /home/muysername.
`/opt` - Для програм, що не є частиною ОС та встановлюються вже користувачем.
`/tmp` - Тимчасові файли.
`/usr` - Пакети програм, що встановлені користувачами.
`/var` - Файли, що часто змінюється. Наприклад, логи ОС та різних програм.
```

Шлях до файлу вказує його унікальне розташування в файловій системі. Абсолютний шлях - це повний шлях до каталогу або файлу від кореня файлової системи `/`.

Абсолютний шлях до файлу index.html буде:
`/var/www/index.html`

Відносний шлях - це шлях до каталогу або файлу від поточної робочої папки. Якщо ваша поточна папка - /var, то відносний шлях до того самого файлу index.html буде:
`www/index.html`

### Виконайте завдання:
1. Перейти в домашню директорію свого користувача
2. Створити там нову папку за допомогою команди `mkdir`
3. Перейти у новостворену папку та створити текстовий файл за допомогою `nano`
4. Написати довільний текст у файл та зберегти його

## 4. Користувачі ОС
Файл `/etc/passwd` є текстовою базою даних, яка містить інформацію про всі облікові записи користувачів у системі і є однією з найбільш використовуваних схем для виконання аутентифікації в Linux.

Кожен рядок у файлі `/etc/passwd` відведено для певного користувача. Кожен рядок має загалом 7 полів, які розділені `:`.
```
syslog:x:102:106::/home/syslog:/usr/sbin/nologin
messagebus:x:103:107::/nonexistent:/usr/sbin/nologin
_apt:x:104:65534::/nonexistent:/usr/sbin/nologin
rfadmin:x:1000:1000::/home/rfadmin:/bin/bash
```

Як ви могли побачити, /etc/passwd зберігає загальну інформацію про користувача, але також ви побачили, що поле пароля містить лише символ x. Це місце, де використовується /etc/shadow. Файл /etc/shadow зберігає зашифровані паролі користувачів та деякі додаткові властивості, пов'язані з паролями користувачів. Усі 9 полів у файлі /etc/shadow розділяються двокрапкою, і є один запис для кожного користувача, перерахованого у файлі /etc/passwd. Приклад запису: 
```
rfadmin:$y$j9T$zxM[...]aS.$XM6[...]66E:19278:0:99999:7::19285:
```

### Виконайте завдання:
1. Створити нового користувача командою `adduser`
2. Перевірити новоствореного користувача командою `id <username>`
3. Видалити новоствореного користувача командою `deluser --remove-home <name>`

## 5. Репозиторії та програми
Під час встановлення нових програм в Linux вони встановлюються з репозиторію. У APT є файл з назвою `/etc/apt/sources.list`, який містить список репозиторіїв, які він використовує. Виконання команди `apt-get update` в командному рядку оновлює базу даних APT з усіма наявними пакетами.
Нижче наведено приклад того, що може бути в файлі `/etc/apt/sources.list`:
```
deb http://gb.archive.ubuntu.com/ubuntu/ bionic main restricted
deb http://gb.archive.ubuntu.com/ubuntu/ bionic multiverse
deb http://security.ubuntu.com/ubuntu/ bionic-security restricted multiverse universe main
```

Є два варіанти для встановлення нових програм. Перший - це встановлення з репозиторію. Другий - встановлення з архіву, який ви завантажите з сайту вендора продукту. Щоб встановити пакет з репозиторію, виконайте команду:
`apt-get install <name-of-package>`

Це дозволить знайти пакет в базі даних APT, щоб переконатися, чи присутній необхідний пакет у репозиторіях, вказаних у файлі `/etc/apt/sources.list`. Якщо пакет є, то система попросить підтвердити встановлення, і після позитивної відповіді, встановить пакет. Якщо пакет відсутній, APT повідомить вас, і вам доведеться знайти інший репозиторій, який містить цей пакет. 

Для видалення пакету використовуйте команду `apt-get remove <ім'я_пакету>`. Ця команда видалить пакет, залишивши всі файли конфігурації недоторканими та в місці, де вони були розташовані.
Гарною практикою є регулярно проводити очищення файлової системи, позбуваючись від непотрібних пакетів у локальному репозиторії. Нижче наведено приклади, як це можна зробити:
* Команда `apt-get clean` використовується для очищення пакетів та файлів із сценаріями у каталозі `/var/cache/apt/archives/`.
* Команда `apt-get autoclean` видаляє застарілі deb-пакети.
* Команда `apt-get autoremove` використовується для видалення застарілих пакетів, які були автоматично встановлені для виконання залежностей деяких пакетів, але вже не потрібні.

## 6. Сервіси та процеси
### Systemd
`systemd` - це системний менеджер служб для операційних систем Linux. Коли він запускається як перший процес під час завантаження, він ініціалізує та підтримує служби користувацького простору.
Команда `systemctl` використовується для взаємодії з systemd. Якщо ви просто виконаєте команду systemctl без будь-яких аргументів, вона виведе список усіх завантажених та активних сервісів.
Існують кілька корисних команд, які можна використовувати з systemctl для управління службами:
```
'systemctl start <ім'я>' - запустити службу.
'systemctl restart <ім'я>' - перезапустити службу.
'systemctl stop <ім'я>' - зупинити службу.
'systemctl status <ім'я>' - вивести статус служби.
'systemctl enable <ім'я>' - встановити запуск служби під час завантаження.
'systemctl disable <ім'я>' - заборонити запуск служби при завантаженні.
```

Процеси в Linux дуже схожі на процеси у Windows. В них є PID (Process ID), PPID (Parent Process ID), CMD - команда яка запустила цей процес. Команда `ps` видає список процесів, хоча я особисто полюбляю `htop`. 

## 7. Фаєрвол UFW та iptables
Ubuntu має свій власний фаєрвол, відомий як ufw (uncomplicated firewall) - "нескладний фаєрвол". ufw є простішим за стандартні команди iptables в Linux. Ви можете також керувати ufw з графічного інтерфейсу. Брандмауер вимкнено за замовчуванням. Щоб увімкнути брандмауер, виконайте наступну команду з терміналу:
`sudo ufw enable`

Наприклад, ви хочете дозволити трафік HTTPS на порті 443. Для цього ви можете виконати таку команду:
`sudo ufw allow 443`

Ви можете переглянути правила, які ви створили, за допомогою наступної команди:
`sudo ufw status`

Для видалення правила додайте слово "delete" перед правилом. Наприклад, щоб припинити вхідний HTTPS трафік на порт 443, виконайте наступну команду:
`sudo ufw delete allow 443`

## 8. Рекомендації по безпеці Linux OS
1. Використовувати SSH з приватним/публічним ключем замість паролю для автентифікації користувача. У налаштуванні SSH серверу забороніть логін з паролем (Деталі будуть у наступих уроках).
2. Якщо ви керуєте кількома серверами, обмежіть доступ до їх SSH портів на 1-ну IP адресу - jump host. Налаштуйте VPN сервер і використовуйте його як “source ip address” для SSH підключень. 
3. Якщо з цим сервером будуть комунікувати інші сутності, переконайтеся що весь трафік зашифровано. (HTTPS, nginx з безкоштовним let’s encrypt сертифікатом, детальніше в наступних уроках).
4. Не використовуйте FTP, Telnet, та Rlogin / Rsh, оскільки вони застарілі та не шифрують трафік.
5. Обмежте кількість встановлених програм на конкретній ОС. Більше програм - більше вразливостей. Один сервер під одну задачу.
6. Тримайте операційну систему та встановлені програми оновленими.
7. Встановіть ліміт на кількість невдалих спроб залогінитись. [Бельше тут](https://www.cyberciti.biz/tips/rhel-centos-fedora-linux-log-failed-login.html). `faillog -M 10 -u <username>`
8. Періодично перевіряйте встановлені сервіси на вашому сервері та видаляйте старі/непотрібні. `systemctl list-unit-files --type=service` для перевірки та `systemctl disable <імʼя сервісу>` для зупинки та виключення автозапуску сервісу.
9. Періодично перевіряйте видкриті порти та сервіси, що їх слухають 
`netstat -tulpn`
10. Якщо ви адмініструєте багато серверів, викорситовуйте OpenLDAP для автентифікації, щоб не створювати нових користувачів на кожному сервері, а використовувати тільки один аккаунт.
11. Встановіть антивірус або IDS систему на сервери.
12. Для конкретних програм, що використовуються на вашому сервері, пошукайте security best practives для їх налаштування (apache/nginx/databases/etc).
13. Робіть бекапи.
14. За можливості, регулярно скануйте сервери на вразливості та патчіть їх.

## 9. Домашнє завдання
1. https://tryhackme.com/room/linuxmodules
2. https://tryhackme.com/room/ninjaskills
3. https://tryhackme.com/room/bashscripting
4. https://tryhackme.com/room/linuxstrengthtraining
5. https://cmdchallenge.com
