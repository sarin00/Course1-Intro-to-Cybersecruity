## 1. Що таке Web Application (веб застосунок)?

Будь-який застосунок - це програма. Веб застосунок - це програма що доступна через інтернет, зазвичай через веб браузер. Сама ця програма запущена десь на віддаленому сервері, а ваш браузер підключається до цього сервера і взаємодіє з цією програмою. Наприклад, Kibana з ELK стеку є веб застосунком. Ми підключаємось до Kibana через браузер по HTTP, відправляємо кібані різні команди, а кібана в свою чергу взаємодіє з elasticsearch.

## 2. Різниця між веб сайтом та веб застосунком
`Веб сайт` - це просто статична інформація яка відправляється від сервера клієнту і показується в браузері. Це сайт який можна переглядати, але не можна з ним взаємодіяти (залогінитись, додати туди якусь інформацію, показати нам якісь нові/конкретні дані, тощо). Приклад - www.sarin00.com. Це просто HTML та CSS сторінки з інформацією, з якою нічого не можна зробити.  
`Веб застосунок` - це саме програма що запущена на якомусь сервері, програма з якою ми можемо взаємодіяти через якийсь клієнт, наприклад мобільний застосунок чи браузер. Наприклад, з web apps соціальних мереж ми можемо залогінитись, зробити якийсь пост, подивитись сторінки інших людей, додати фото. З web apps інтернет-магазинів ми можемо переглядати товари, фільтрувати пошук того що нам треба, додавати картку та оплачувати замовлення.

Поширеними типами Web applications є:
1. SaaS програми (Gmail, Google Drive, Microsoft Teams, Meets, etc)
2. Ecommerce (Rozetka, Amazon, Ebay)
3. Email web apps (Gmail, Outlook)
4. Online banking

## 3. Як це працює?
Як і все з HTTP, робота веб застосунків ділиться на client-side та server-side. Client-side це наш з вами браузер чи мобільний застосунок (яку картинку нам показують, як виглядають всі іконки та кнопки, який запит відправляється на сервер коли ми натискаємо кнопки). Server-side це робота самої програми на сервері (як реагувати на клієнтські кліки по кнопках, запитати інформацію в бази даних щоб показати її клієнту, автентифікація клієнта, тощо).

## 4. Що таке Web Server (веб сервер)?
В цьому розділі ми говоримо про веб сервер. Веб сервер, такий як nginx чи apache2 - це програма що як мінімум працює як http сервер, обробляє запити клієнта(браузер, мобільний застосунок), відправляє відповіді клієнту, та передає необхідні дані на web-application. Візуалізація нижче:

![webappserver](https://github.com/sarin00/Course1-Intro-to-Cybersecruity/blob/main/%D1%8F%D0%94%D0%BE%D0%B4%D0%B0%D1%82%D0%BA%D0%BE%D0%B2%D1%96%20%D0%BC%D0%B0%D1%82%D0%B5%D1%80%D1%96%D0%B0%D0%BB%D0%B8/web-app-server.png)

## 5. Навіщо потрібні web servers (веб севрери)?
1. SSL/TLS. Веб сервери беруть на себе задачу шифрування даних між собою та клієнтом.
2. Load balancing. Веб сервери типу nginx можуть виступати в ролі load balancer, або балансувальника навантаження. Якщо у вас не один сервер з веб-застосунком, а кілька (багато клієнтів, можливо боїтесь що один з серверів вийде з ладу, тощо) - то всі запити від клієнта треба балансувати між вашими web applications, що і робить веб сервер.
3. API gateway. Може вистувпати як API gateway для вашого web app.
4. Firewall. Веб сервери, часто у взаємодії з іншими програмами, можуть виступати в ролі web application firewall, або WAF. WAF фільтруватиме всі запити що приходять від клієнта, перевірятиме і блокуватиме IP адреси поганих клієнтів, тощо
5. Proxy. Веб сервери можуть виступати в ролі різних proxy, при необхідності.
6. Багато інших пунктів, які нам зараз не критичні.

## 6. Практичне завдання
Спочатку ми встановимо і запустимо web application на node.js, після чого ми встановимо і запустимо веб сервер nginx. Ми сконфігуруємо NGINX на перенаправлення HTTP запитів на node.js застосунок. Потім ми встановимо SSL сертифікат на nginx. Майже всі команди треба запускати з SUDO.

1. Встановити nodejs та npm  
`apt install nodejs npm -y`  
2. Перевірити встановлення nodejs  
`node --version`  
3. Завантажити код node.js застосунку  
`git clone https://github.com/sarin00/nodehttps.git`  
4. Перейти у новостворену папку з кодом веб застосунку  
5. Встановити залежності  
`npm install`  
6. Встановити pm2 (програма що запускатиме наш js application в окремому процесі)  
`npm i pm2 -g`  
7. Запустити node.js застосунок  
`pm2 start index.js`  
8. Запустити фаєрвол, відкрити порти для ssh(22), http(80), https(443), та наш веб застосунок(5000)  
```
ufw allow ssh
ufw allow http
ufw allow https
ufw allow 5000
ufw enable
```
8. Перевірити що наш node.js web-застосунок працює  
Зробити у Postman запит на `http://<ip вашого сервера>:5000`  
9. Встановити nginx (веб сервер)  
`apt install nginx -y`  
10. Редагувати конфіг nginx  
`nano /etc/nginx/sites-available/default`  
11. Додати в конфіг такі дані:  
```
server_name yourdomain.com www.yourdomain.com;

 location / {
        proxy_pass http://localhost:5000; #whatever port your app runs on
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
    }
```
12. Перевірити конфігураційний файл nginx на помилки  
`sudo nginx -t`  
13. Перезапустити nginx  
`service nginx restart`  
14. Перевірити доступ до сайту на порті 80  
15. Купити доменне ім’я для сервера, додати записи типу domain.com та www.domain.com у вашому провайдері домену і переводити запити цих доменів на ваш сервер.  
16. Змінити nginx конфіг щоб там були новокуплене доменне імʼя.  
`nano /etc/nginx/sites-available/default`  
Має бути так:  
`server_name yourdomain.com www.yourdomain.com;`  
17. Додати SSL з Letsencrypt
```
apt install snapd
snap install --classic certbot
ln -s /snap/bin/certbot /usr/bin/certbot
certbot --nginx (будуть додаткові опції та вибір)
```
[Інструкції по Let'sEncrypt боту](https://certbot.eff.org/instructions?ws=nginx&os=ubuntufocal)

## 7. Додаткові матеріали та завдання
[Більше про TLS та сертифікати](https://habr.com/ru/companies/plesk/articles/502604/)  
[Tryhackme HTTP](https://tryhackme.com/room/httpindetail)  
[Крутий креш-курс по node.js](https://www.youtube.com/watch?v=fBNz5xF-Kx4&list=WL&index=16)
